<!DOCTYPE html>
<html lang="vi" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quy Trình Git & CI/CD</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #020617; /* slate-950 */
            color: #94a3b8; /* slate-400 */
        }
        h1, h2, h3, h4, h5, h6 {
            color: #e2e8f0; /* slate-200 */
        }
        code, pre {
            font-family: 'JetBrains Mono', monospace;
        }
        .accent-text {
            color: #38bdf8; /* sky-400 */
        }
        .card {
            background-color: #0f172a; /* slate-900 */
            border: 1px solid #1e293b; /* slate-800 */
            transition: border-color 0.3s ease-in-out;
        }
        .card:hover {
            border-color: #38bdf8;
        }
        .section-title {
            font-weight: 700;
            font-size: 2.25rem; /* text-4xl */
            letter-spacing: -0.025em;
        }
        
        /* Animation triggering */
        .animated { opacity: 0; transition: opacity 1s, transform 1s; }
        .slide-up { transform: translateY(30px); }
        .visible { opacity: 1; transform: translate(0, 0); }

        /* CI/CD Pipeline Styles */
        .pipeline-bg { background-image: radial-gradient(#1e293b 1px, transparent 1px); background-size: 20px 20px; }
        #artifact {
            transition: all 1.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            position: absolute;
            opacity: 0;
            transform: scale(0.5);
        }
        .config-popup {
            transition: all 0.5s ease-out;
            opacity: 0;
            transform: translateY(10px) scale(0.9);
            pointer-events: none;
        }
        .config-popup.show { opacity: 1; transform: translateY(0) scale(1); }
        .deploy-btn { 
            transition: all 0.3s ease;
            background-color: #1e293b;
            border: 1px solid #334155;
            color: #94a3b8;
        }
        .deploy-btn:not(:disabled):hover {
            background-color: #334155;
            border-color: #38bdf8;
            color: #e2e8f0;
        }
        .deploy-btn.active, .deploy-btn.active:hover {
            background-color: #0284c7; /* sky-600 */
            border-color: #38bdf8;
            color: #fff;
        }
        .deploy-btn.hidden { display: none; }
        .deploy-btn:disabled { cursor: not-allowed; background-color: #334155; opacity: 0.5; }

        /* Static Git Workflow Timeline */
        .timeline-container::before { content: ''; position: absolute; top: 0; left: 1.25rem; /* left-5 */ transform: translateX(-50%); width: 2px; height: 100%; background-color: #1e293b; }
        .timeline-item { position: relative; padding-left: 3.5rem; /* pl-14 */ padding-bottom: 2.5rem; }
        .timeline-dot { position: absolute; top: 0.25rem; left: 1.25rem; transform: translateX(-50%); width: 1rem; height: 1rem; border-radius: 9999px; background-color: #0f172a; border: 2px solid #334155; }
        
        /* Style for commit hashes and important keywords */
        .commit-hash {
            background-color: #334155;
            color: #fde047; /* yellow-300 */
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.8em;
        }
        .highlight-text {
            color: #f59e0b; /* amber-500 */
        }
        .stage-description {
             min-height: 5rem; /* Ensure consistent height */
        }
    </style>
</head>
<body class="overflow-x-hidden">

    <header class="text-center p-8 my-16 md:my-24">
        <div class="max-w-4xl mx-auto">
            <h1 class="text-4xl md:text-6xl font-bold tracking-tight">
                Quy Trình <span class="accent-text">Git & CI/CD</span>
            </h1>
            <p class="mt-6 text-lg md:text-xl max-w-2xl mx-auto">
                Tài liệu hướng dẫn về quy trình làm việc và triển khai phần mềm một cách có hệ thống, giúp giảm thiểu rủi ro và tăng hiệu suất.
            </p>
        </div>
    </header>

    <main>
        <!-- Problem Section -->
        <section id="problem" class="py-20 px-4">
             <div class="max-w-6xl mx-auto">
                <div class="text-center">
                    <h2 class="section-title mb-4 animated slide-up">Rủi Ro Khi Thiếu Quy Trình</h2>
                    <p class="text-lg mb-12 animated slide-up" style="animation-delay: 0.2s;">Các vấn đề kỹ thuật phổ biến khi làm việc nhóm trên cùng một codebase.</p>
                </div>
                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <div class="card p-6 rounded-lg animated slide-up" style="animation-delay: 0.4s;">
                        <div class="mb-4"><svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-red-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" /></svg></div>
                        <h3 class="text-xl font-bold mb-2">Merge Conflicts & Rework</h3>
                        <p>Xung đột code xảy ra thường xuyên khi nhiều người cùng chỉnh sửa một file, dẫn đến việc phải làm lại (rework) và lãng phí thời gian.</p>
                    </div>
                    <div class="card p-6 rounded-lg animated slide-up" style="animation-delay: 0.6s;">
                        <div class="mb-4"><svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-amber-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" /></svg></div>
                        <h3 class="text-xl font-bold mb-2">Environment Discrepancy</h3>
                        <p>Sự khác biệt về cấu hình và phiên bản thư viện giữa các môi trường (local, staging, prod) gây ra lỗi "It works on my machine".</p>
                    </div>
                    <div class="card p-6 rounded-lg animated slide-up" style="animation-delay: 0.8s;">
                        <div class="mb-4"><svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-yellow-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" /></svg></div>
                        <h3 class="text-xl font-bold mb-2">Unpredictable Deployments</h3>
                        <p>Việc triển khai thiếu kiểm soát, không rõ phiên bản code nào đang chạy trên production, gây khó khăn cho việc debug và hotfix.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Solution Section -->
        <section id="solution" class="py-20 px-4 bg-slate-900/50">
            <div class="max-w-6xl mx-auto">
                <div class="text-center">
                    <h2 class="section-title mb-4 animated slide-up">Giải Pháp: Git Workflow</h2>
                    <p class="text-lg mb-12 animated slide-up" style="animation-delay: 0.2s;">Áp dụng các nguyên tắc cơ bản của version control để tạo ra một quy trình làm việc có thể dự đoán.</p>
                </div>
                <div class="grid lg:grid-cols-3 gap-8">
                    <div class="card p-6 rounded-lg animated slide-up" style="animation-delay: 0.4s;">
                        <div class="mb-4"><svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-green-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" /></svg></div>
                        <h3 class="text-xl font-bold mb-2">`main` là Integration Branch</h3>
                        <p>Branch `main` là nơi tích hợp tất cả các tính năng và được deploy liên tục lên môi trường Staging để kiểm thử.</p>
                    </div>
                    <div class="card p-6 rounded-lg animated slide-up" style="animation-delay: 0.6s;">
                        <div class="mb-4"><svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-sky-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M17.657 18.657l-4.243-4.243m0 0l-4.243 4.243m4.243-4.243L12 6.75m4.243 7.664l4.243-4.243" /></svg></div>
                        <h3 class="text-xl font-bold mb-2">Phát triển trên Feature Branch</h3>
                        <p>Mỗi tính năng hoặc bản sửa lỗi được phát triển trên một branch riêng biệt để cô lập các thay đổi, tránh ảnh hưởng đến người khác.</p>
                    </div>
                    <div class="card p-6 rounded-lg animated slide-up" style="animation-delay: 0.8s;">
                        <div class="mb-4"><svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-violet-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg></div>
                        <h3 class="text-xl font-bold mb-2">Release bằng Git Tag</h3>
                        <p>Việc deploy lên Production được quyết định bằng cách tạo Git Tag trên một commit đã được kiểm thử kỹ lưỡng.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- NEW SECTION: Branching Strategy -->
        <section id="branching-strategy" class="py-20 px-4">
            <div class="max-w-4xl mx-auto">
                <div class="text-center mb-16">
                    <h2 class="section-title mb-4 animated slide-up">Chiến Lược Phân Nhánh (Branching Strategy)</h2>
                    <p class="text-lg mb-12 animated slide-up" style="animation-delay: 0.2s;">
                        Quy trình này chỉ cần <strong class="highlight-text">một (1)</strong> branch tồn tại vĩnh viễn, giúp kho code luôn gọn gàng và dễ quản lý.
                    </p>
                </div>
                <div class="bg-slate-900 border border-slate-800 rounded-lg p-8">
                    <h3 class="text-2xl font-bold mb-4 text-center">Mô Hình Branch</h3>
                    <div class="space-y-6">
                        <div>
                            <h4 class="text-xl font-bold text-green-400">1. Branch chính: `main`</h4>
                            <p>Đây là branch trung tâm, là (source of truth). `main` luôn phản ánh phiên bản code mới nhất đang được tích hợp và chạy trên môi trường Staging.</p>
                        </div>
                        <div>
                            <h4 class="text-xl font-bold text-sky-400">2. Các Branch Tạm Thời (Temporary Branches)</h4>
                            <p class="mb-4">Tất cả các branch khác đều có vòng đời ngắn, được tạo ra để thực hiện một nhiệm vụ cụ thể và <strong class="highlight-text">phải được xóa đi</strong> sau khi đã merge vào `main`.</p>
                            <ul class="list-disc pl-5 space-y-3">
                                <li><strong>`feature/*`</strong> (ví dụ: `feature/TASK-123-new-login`): Dùng để phát triển các tính năng mới. Mỗi task sẽ có một feature branch riêng.</li>
                                <li><strong>`bugfix/*`</strong> (ví dụ: `bugfix/TASK-456-fix-button`): Dùng để sửa các lỗi được phát hiện trên Staging trong quá trình phát triển thông thường.</li>
                                <li><strong>`hotfix/*`</strong> (ví dụ: `hotfix/fix-prod-crash`): <strong class="text-red-400">Chỉ dùng cho trường hợp khẩn cấp</strong> để sửa lỗi nghiêm trọng trên Production. Branch này được tạo từ Git Tag của phiên bản lỗi.</li>
                                <li><strong>`release/*`</strong> (ví dụ: `release/v1.5.1-hotfix`): <strong class="text-cyan-400">Chỉ dùng trong các kịch bản đặc biệt</strong>, ví dụ như khi cần release "nóng" một tính năng bằng cherry-pick.</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- UPDATED: Static Workflow Section for Teams -->
        <section id="workflow" class="py-20 px-4 bg-slate-900/50">
            <div class="max-w-4xl mx-auto">
                <div class="text-center mb-16">
                    <h2 class="section-title mb-4 animated slide-up">Quy Trình Phát Triển Tính Năng Cho Team Lớn</h2>
                    <p class="text-lg mb-12 animated slide-up" style="animation-delay: 0.2s;">
                        Mô hình làm việc song song cho 10 (hay 100) lập trình viên, đảm bảo sự đồng bộ và giảm thiểu xung đột.
                    </p>
                </div>

                <div class="relative timeline-container">
                    <div class="timeline-item animated slide-up">
                        <div class="timeline-dot"></div>
                        <h3 class="flex items-center text-xl font-bold mb-2"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path d="M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3zM6 8a2 2 0 11-4 0 2 2 0 014 0zM16 18v-3a5.972 5.972 0 00-.75-2.906A3.005 3.005 0 0119 15v3h-3zM4.75 12.094A5.973 5.973 0 004 15v3H1v-3a3 3 0 013.75-2.906z" /></svg>0. Phân Rã & Nhận Task</h3>
                        <p class="mb-4">Một tính năng lớn (Epic) sẽ được Tech Lead/Product Manager phân rã thành các task nhỏ hơn trên công cụ quản lý (Jira, Trello...). Mỗi lập trình viên sẽ nhận một task cụ thể, ví dụ: <code class="commit-hash">FEAT-123</code>: Xây dựng Form Đăng nhập, <code class="commit-hash">FEAT-124</code>: Tích hợp API Google Login.</p>
                    </div>
                    <div class="timeline-item animated slide-up">
                        <div class="timeline-dot"></div>
                        <h3 class="flex items-center text-xl font-bold mb-2"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd" /></svg>1. Tạo Feature Branch Từ `main`</h3>
                        <p class="mb-4">Mỗi dev <strong class="highlight-text">luôn</strong> tạo branch mới từ phiên bản code mới nhất và ổn định nhất của `main`. Đặt tên branch rõ ràng theo convention <code class="text-sky-300">{type}/{ticket-id}-{description}</code>.</p>
                        <pre><code class="bg-slate-800 p-3 rounded-md text-sky-300 text-sm block"># Dev A làm task FEAT-123
git checkout main
git pull origin main
git checkout -b feature/FEAT-123-login-form

# Dev B làm task FEAT-124
git checkout main
git pull origin main
git checkout -b feature/FEAT-124-google-login</code></pre>
                    </div>
                    <div class="timeline-item animated slide-up">
                        <div class="timeline-dot"></div>
                        <h3 class="flex items-center text-xl font-bold mb-2"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path d="M5.5 13.5A1.5 1.5 0 014 12V6a1.5 1.5 0 013 0v6a1.5 1.5 0 01-1.5 1.5zM12.5 13.5A1.5 1.5 0 0111 12V6a1.5 1.5 0 013 0v6a1.5 1.5 0 01-1.5 1.5zM20 12a1.5 1.5 0 01-1.5-1.5V6a1.5 1.5 0 00-3 0v6a1.5 1.5 0 01-1.5 1.5h-1a1.5 1.5 0 01-1.5-1.5V6a1.5 1.5 0 00-3 0v6a1.5 1.5 0 01-1.5 1.5H8a1.5 1.5 0 01-1.5-1.5V6a1.5 1.5 0 00-3 0v6a1.5 1.5 0 01-1.5 1.5H1" /></svg>2. Lập Trình và Đồng Bộ Hóa Thường Xuyên</h3>
                        <p class="mb-4">Trong quá trình code, các dev khác cũng merge code của họ vào `main`. Để tránh "xa rời thực tế" và giảm thiểu conflict sau này, mỗi dev cần đồng bộ hóa branch của mình với `main` <strong class="highlight-text">hàng ngày</strong>.</p>
                        <pre><code class="bg-slate-800 p-3 rounded-md text-sky-300 text-sm block"># Đang ở trên branch feature/FEAT-123-login-form
git pull origin main</code></pre>
                        <p class="mt-2 text-sm">Thao tác này sẽ gộp những thay đổi mới nhất từ `main` vào branch của bạn, giúp bạn xử lý các conflict nhỏ ngay lập tức.</p>
                    </div>
                    <div class="timeline-item animated slide-up">
                        <div class="timeline-dot"></div>
                        <h3 class="flex items-center text-xl font-bold mb-2"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z" /></svg>3. Mở Pull Request (PR) "Sớm và Nhỏ"</h3>
                        <p class="mb-4">Ngay khi hoàn thành một phần logic nhỏ và có thể chạy được (dù chưa hoàn thiện toàn bộ task), hãy mở một PR. Đặt tiền tố <code class="commit-hash">[WIP]</code> (Work In Progress) vào tiêu đề để team biết nó chưa sẵn sàng để merge.</p>
                        <ul class="list-disc pl-5 text-sm space-y-1">
                            <li><strong>Lợi ích:</strong> Team có thể thấy tiến độ của bạn, cho feedback sớm, và CI đã có thể chạy test trên code của bạn.</li>
                            <li><strong>PR chất lượng:</strong> Mô tả rõ ràng mục đích, liên kết đến ticket Jira, và có hình ảnh/GIF minh họa nếu là thay đổi UI.</li>
                        </ul>
                    </div>
                    <div class="timeline-item animated slide-up">
                        <div class="timeline-dot"></div>
                        <h3 class="flex items-center text-xl font-bold mb-2"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path d="M2 5a2 2 0 012-2h7a2 2 0 012 2v4a2 2 0 01-2 2H9l-3 3v-3H4a2 2 0 01-2-2V5z" /><path d="M15 7v2a4 4 0 01-4 4H9.828l-1.766 1.767c.28.149.599.233.938.233h2l3 3v-3h2a2 2 0 002-2V9a2 2 0 00-2-2h-1z" /></svg>4. Code Review và Thảo Luận</h3>
                        <p class="mb-4">Khi PR sẵn sàng (bỏ tiền tố <code class="commit-hash">[WIP]</code>), hãy tag ít nhất 1-2 người vào review. Quá trình review là trao đổi hai chiều để nâng cao chất lượng code chung, không phải để chỉ trích.</p>
                    </div>
                    <div class="timeline-item animated slide-up">
                        <div class="timeline-dot"></div>
                        <h3 class="flex items-center text-xl font-bold mb-2"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" /></svg>5. Merge vào `main` và Deploy Staging</h3>
                        <p class="mb-4">Sau khi PR được duyệt và CI báo pass, người duyệt sẽ merge code vào `main` (thường dùng <strong class="highlight-text">Squash and Merge</strong> để giữ lịch sử `main` gọn gàng). CI/CD sẽ tự động deploy code mới nhất lên môi trường Staging.</p>
                    </div>
                    <div class="timeline-item animated slide-up">
                        <div class="timeline-dot"></div>
                        <h3 class="flex items-center text-xl font-bold mb-2"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v1H5V4zM5 8h10a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1V9a1 1 0 011-1z" /></svg>6. Quy Trình Release: Từ Staging đến Production</h3>
                        <p class="mb-4">Đây là bước quan trọng, đòi hỏi sự phối hợp giữa Dev, QA, và Product Manager. <strong class="highlight-text">Không phải mọi commit trên `main` đều sẽ được release.</strong></p>
                        
                        <div class="bg-slate-800/50 border border-slate-700 rounded-lg p-4 mt-4">
                            <h4 class="font-bold text-lg text-sky-300 mb-2">Ví dụ về một chu kỳ Release hàng tuần:</h4>
                            <p class="text-sm mb-4">Giả sử team quyết định release vào thứ Năm hàng tuần. Đến sáng thứ Năm, Tech Lead sẽ xem xét trạng thái của `main`.</p>
                            <p class="mb-2">Lịch sử commit trên `main` có thể trông như thế này:</p>
                            <pre><code class="text-xs block text-slate-400 p-3 bg-black rounded-md">
<code class="commit-hash">c4a5f6</code> (HEAD -> main) feat(FEAT-125): Add user profile page
<code class="commit-hash">b3d4e5</code> feat(FEAT-124): Integrate Google Login
<code class="commit-hash">a2c3d4</code> feat(FEAT-123): Add login form
<code class="commit-hash">f1a2b3</code> (tag: v1.4.0) chore: Update dependencies
...
                            </code></pre>
                            <ul class="list-disc pl-5 text-sm space-y-2 mt-4">
                                <li><strong>Họp Release:</strong> Team sẽ họp nhanh để xác nhận. QA báo cáo rằng cả 3 feature 123, 124, 125 đều đã được kiểm tra và hoạt động tốt trên Staging.</li>
                                <li><strong>Quyết định Release:</strong> Tech Lead quyết định rằng commit <code class="commit-hash">c4a5f6</code> đủ điều kiện để release.</li>
                                <li><strong>Tạo Git Tag (Hành động chính):</strong> Tech Lead sẽ tạo một tag mới ngay tại commit đó. Tag phải tuân theo <a href="https://semver.org/" target="_blank" class="text-sky-400 hover:underline">Semantic Versioning</a>.
                                    <pre><code class="bg-black p-3 rounded-md text-sky-300 text-sm block mt-2"># Lệnh được thực thi bởi người có thẩm quyền
git tag -a v1.5.0 c4a5f6 -m "Release: User Profile, Google Login, Login Form"
git push origin v1.5.0</code></pre>
                                </li>
                                <li><strong>Kích hoạt Pipeline Production:</strong> Hệ thống CI/CD được cấu hình để lắng nghe sự kiện push tag. Khi nhận được tag <code class="commit-hash">v1.5.0</code>, pipeline sẽ tự động checkout code tại commit <code class="commit-hash">c4a5f6</code> và deploy nó lên Production.</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- CI/CD Interactive Section -->
        <section id="cicd" class="py-20 px-4 bg-slate-900/50">
            <div class="max-w-7xl mx-auto text-center">
                <h2 class="section-title mb-4 animated slide-up">Quy Trình CI/CD</h2>
                <p class="text-lg mb-2 animated slide-up" style="animation-delay: 0.2s;">Nguyên tắc: <span class="accent-text font-semibold">Build Once, Deploy Many</span></p>
                <p class="max-w-3xl mx-auto mb-12 animated slide-up" style="animation-delay: 0.4s;">Xây dựng artifact một lần duy nhất và "thăng cấp" (promote) nó qua các môi trường. Việc deploy Production được kiểm soát chặt chẽ.</p>

                <div id="pipeline-container" class="relative p-8 rounded-lg pipeline-bg border border-slate-800">
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-8 items-center">
                        <!-- Stages -->
                        <div id="build-stage" class="relative text-center p-4 bg-slate-800/50 rounded-lg border border-slate-700 h-full flex flex-col justify-between"><h3 class="text-lg font-bold">1. BUILD</h3><p class="text-sm stage-description">Tạo ra một artifact (vd: Docker image) có thể deploy.</p></div>
                        <div id="preprod-stage" class="relative text-center p-4 bg-slate-800/50 rounded-lg border border-slate-700 h-full flex flex-col justify-between"><div class="pipeline-arrow left-[-15%] hidden md:block"></div><h3 class="text-lg font-bold">2. STAGING</h3><p class="text-sm stage-description">Deploy tự động cho QA/QC kiểm thử tích hợp.</p><div id="preprod-config" class="config-popup absolute bottom-full mb-2 w-full left-0 px-4"><div class="bg-indigo-500/10 border border-indigo-500 text-indigo-300 text-xs px-2 py-1 rounded-md inline-block">Config: Staging</div></div></div>
                        <div id="staging-stage" class="relative text-center p-4 bg-slate-800/50 rounded-lg border border-slate-700 h-full flex flex-col justify-between"><div class="pipeline-arrow left-[-15%] hidden md:block"></div><h3 class="text-lg font-bold">3. APPROVAL</h3><p class="text-sm stage-description">Chờ phê duyệt và tạo Git Tag để deploy Production.</p><div id="staging-config" class="config-popup absolute bottom-full mb-2 w-full left-0 px-4"><div class="bg-amber-500/10 border border-amber-500 text-amber-300 text-xs px-2 py-1 rounded-md inline-block">Action: Create Tag</div></div></div>
                        <div id="prod-stage" class="relative text-center p-4 bg-slate-800/50 rounded-lg border border-slate-700 h-full flex flex-col justify-between"><div class="pipeline-arrow left-[-15%] hidden md:block"></div><h3 class="text-lg font-bold">4. PRODUCTION</h3><p class="text-sm stage-description">Deploy cho người dùng cuối sau khi có Git Tag mới.</p><div id="prod-config" class="config-popup absolute bottom-full mb-2 w-full left-0 px-4"><div class="bg-green-500/10 border border-green-500 text-green-300 text-xs px-2 py-1 rounded-md inline-block">Config: Production</div></div></div>
                    </div>
                    <div id="artifact" class="left-1/6 top-1/2 -translate-y-1/2">
                         <div class="w-16 h-16 bg-sky-500/20 border-2 border-sky-400 rounded-lg flex items-center justify-center shadow-lg shadow-sky-500/20 flex-col text-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-sky-300" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4M4 7v10l8 4M12 11v10" /></svg>
                            <span id="artifact-tag" class="text-xs font-mono text-sky-400 mt-1"></span>
                         </div>
                    </div>
                </div>
                <div id="buttons-container" class="mt-8 flex justify-center items-center gap-4 h-12">
                    <button id="start-btn" class="deploy-btn active font-semibold py-2 px-6 rounded-lg text-base">Bắt đầu Build</button>
                    <button id="preprod-btn" class="deploy-btn hidden font-semibold py-2 px-6 rounded-lg text-base">Deploy to Staging</button>
                    <button id="staging-btn" class="deploy-btn hidden font-semibold py-2 px-6 rounded-lg text-base">Approve & Tag for Prod</button>
                    <button id="reset-btn" class="deploy-btn hidden font-semibold py-2 px-6 rounded-lg text-base">Làm lại</button>
                </div>
            </div>
        </section>
        
        <!-- Bug Handling & Release Section -->
        <section id="bug-handling" class="py-20 bg-slate-900/50">
            <div class="max-w-4xl mx-auto px-4">
                <div class="text-center mb-16">
                    <h2 class="section-title mb-4 animated slide-up">Kịch Bản Release Phức Tạp & Xử Lý Sự Cố</h2>
                    <p class="text-lg mb-12 animated slide-up" style="animation-delay: 0.2s;">Cách xử lý khi `main` chứa các feature chưa sẵn sàng để release.</p>
                </div>

                <!-- Scenario 1: Block release -->
                <div class="mb-16">
                    <h3 class="flex items-center text-2xl font-bold mb-6"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-3 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636" /></svg>Kịch bản 1 (Phổ biến): Tạm Dừng Release ("Release Train")</h3>
                    <div class="mt-4 mb-6 text-sm bg-red-900/50 p-4 rounded-lg border-l-4 border-red-500">
                        <p><strong class="text-red-400">Tình huống:</strong> `main` chứa 3 feature mới (A, B, C). QA kiểm tra trên Staging và phát hiện `feat-B` có bug nghiêm trọng. `feat-A` và `feat-C` đã ổn.</p>
                        <p class="mt-2"><strong class="highlight-text">Giải pháp:</strong> "Chuyến tàu release" sẽ dừng lại. Không ai được phép deploy cho đến khi `feat-B` được sửa. Đây là giải pháp ưu tiên vì nó đảm bảo chất lượng và sự ổn định của `main`.</p>
                    </div>
                    <div class="relative timeline-container">
                        <div class="timeline-item animated slide-up"><div class="timeline-dot"></div><h4 class="text-lg font-bold mb-2">1. Thông báo & Dừng Release</h4><p>QA/Tech Lead thông báo cho cả team: "Release bị tạm dừng do có bug trong `feat-B`. Không tạo tag release lúc này."</p></div>
                        <div class="timeline-item animated slide-up"><div class="timeline-dot"></div><h4 class="text-lg font-bold mb-2">2. Sửa Bug</h4><p class="mb-4">Dev chịu trách nhiệm `feat-B` tạo một PR mới để sửa bug và merge vào `main`.</p></div>
                        <div class="timeline-item animated slide-up"><div class="timeline-dot"></div><h4 class="text-lg font-bold mb-2">3. Xác nhận lại</h4><p class="mb-4">CI/CD deploy phiên bản `main` mới nhất (đã vá lỗi) lên Staging. QA thực hiện kiểm tra hồi quy (regression test) để đảm bảo bản vá không phá hỏng `feat-A` và `feat-C`.</p></div>
                        <div class="timeline-item animated slide-up"><div class="timeline-dot"></div><h4 class="text-lg font-bold mb-2">4. Tiếp tục Release</h4><p class="mb-4">Khi Staging đã ổn định, quy trình release tiếp tục như bình thường (tạo tag trên commit mới nhất của `main`).</p></div>
                    </div>
                </div>

                <!-- Scenario 2: Cherry-pick release (UPDATED WITH USER'S EXAMPLE) -->
                <div class="mb-16">
                    <h3 class="flex items-center text-2xl font-bold mb-6"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-3 text-cyan-400" viewBox="0 0 20 20" fill="currentColor"><path d="M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z" /><path fill-rule="evenodd" d="M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z" clip-rule="evenodd" /></svg>Kịch bản 2 (Khẩn cấp): Release một commit duy nhất</h3>
                    <div class="mt-4 mb-6 text-sm bg-cyan-900/50 p-4 rounded-lg border-l-4 border-cyan-500">
                        <p><strong class="text-cyan-400">Tình huống:</strong> `main` đã tích hợp nhiều feature mới, nhưng có yêu cầu nghiệp vụ <strong class="highlight-text">bắt buộc</strong> phải release chỉ một feature duy nhất đã được test kỹ, trong khi các feature khác chưa sẵn sàng.</p>
                         <p class="mt-2"><strong class="highlight-text">Giải pháp:</strong> Tạo một `release` branch tạm thời từ phiên bản production ổn định, và chỉ "nhặt" (cherry-pick) commit của feature cần release sang đó.</p>
                    </div>
                    <div class="relative timeline-container">
                        <div class="timeline-item animated slide-up"><div class="timeline-dot"></div><h4 class="text-lg font-bold mb-2">1. Xác định commit cần release và phiên bản ổn định gần nhất</h4>
                          <p class="mb-2">Tech Lead xem `git log` của `main` và xác định:</p>
                           <pre><code class="text-xs block text-slate-400 p-3 bg-black rounded-md">
<code class="commit-hash">c4a5f6</code> (HEAD -> main) feat: Add user profile page
<code class="commit-hash">b3d4e5</code> feat: Integrate Google Login
<code class="commit-hash">a2c3d9</code> feat: Add password reset
<code class="commit-hash text-green-400">a2c3d4</code> feat: Add login form <span class="text-green-400">&lt;-- Commit cần release</span>
<code class="commit-hash">f1a2b3</code> (tag: v1.4.0) chore: Update dependencies <span class="text-green-400">&lt;-- Phiên bản production ổn định</span>
                            </code></pre>
                            <p class="mt-2">Mục tiêu là chỉ release commit <code class="commit-hash text-green-400">a2c3d4</code>.</p>
                        </div>
                        <div class="timeline-item animated slide-up"><div class="timeline-dot"></div><h4 class="text-lg font-bold mb-2">2. Tạo `release` branch từ phiên bản production gần nhất</h4><p class="mb-4">Tạo một branch mới từ tag production mới nhất (`v1.4.0`). Branch này sẽ là nền tảng "sạch" cho bản release mới.</p><pre><code class="bg-slate-800 p-3 rounded-md text-sky-300 text-sm block">git checkout -b release/v1.4.1-login-form v1.4.0</code></pre></div>
                        <div class="timeline-item animated slide-up"><div class="timeline-dot"></div><h4 class="text-lg font-bold mb-2">3. "Nhặt" (Cherry-pick) commit cần release</h4><p class="mb-4">Dùng `git cherry-pick` để sao chép các thay đổi của commit <code class="commit-hash">a2c3d4</code> vào `release` branch.</p><pre><code class="bg-slate-800 p-3 rounded-md text-sky-300 text-sm block"># Đang trên branch release/v1.4.1-login-form
git cherry-pick a2c3d4</code></pre>
                        <p class="mt-2 text-sm">Lúc này, branch `release/v1.4.1-login-form` đã chứa code của v1.4.0 cộng với tính năng Login Form.</p>
                        </div>
                        <div class="timeline-item animated slide-up"><div class="timeline-dot"></div><h4 class="text-lg font-bold mb-2">4. Deploy `release` branch và Test</h4><p class="mb-4">Push `release` branch lên và cấu hình CI/CD để deploy branch này lên Staging (hoặc một môi trường test riêng cho hotfix). QA vào xác nhận lần cuối cùng.</p></div>
                         <div class="timeline-item animated slide-up"><div class="timeline-dot"></div><h4 class="text-lg font-bold mb-2">5. Gắn Tag và Deploy Production</h4><p class="mb-4">Khi đã xác nhận ổn, gắn tag mới vào `release` branch và đẩy tag lên để deploy Production.</p><pre><code class="bg-slate-800 p-3 rounded-md text-sky-300 text-sm block"># Gắn tag vào commit cuối của branch release/v1.4.1-login-form
git tag -a v1.4.1 -m "Release: Add login form feature"
git push origin v1.4.1
</code></pre></div>
                        <div class="timeline-item animated slide-up"><div class="timeline-dot"></div><h4 class="text-lg font-bold mb-2">6. Hậu xử lý</h4><p class="mb-4"><strong class="highlight-text">Quan trọng:</strong> `main` vẫn giữ nguyên lịch sử. Team tiếp tục test các feature còn lại trên `main`. Khi tất cả đã sẵn sàng, lần release tiếp theo (ví dụ `v1.5.0`) sẽ được tạo từ `main` như bình thường. Git sẽ tự động xử lý và không áp dụng lại thay đổi của `a2c3d4`.</p></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Hotfix & Revert Section -->
        <section id="hotfix-revert" class="py-20">
            <div class="max-w-6xl mx-auto px-4">
                <div class="text-center">
                    <h2 class="section-title mb-4 animated slide-up">Xử Lý Sự Cố Production</h2>
                    <p class="text-lg mb-12 animated slide-up" style="animation-delay: 0.2s;">Quy trình xử lý các lỗi nghiêm trọng trên môi trường Production.</p>
                </div>
                
                <div class="grid lg:grid-cols-2 gap-12">
                    <div>
                        <h3 class="flex items-center text-2xl font-bold mb-6"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-3 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" /></svg>Quy Trình Hotfix</h3>
                         <div class="relative timeline-container">
                             <div class="timeline-item animated slide-up"><div class="timeline-dot"></div><h4 class="text-lg font-bold mb-2">1. Tạo Hotfix Branch từ Tag Lỗi</h4><p class="mb-4">Khi có lỗi nghiêm trọng trên Production, checkout code từ chính <strong class="highlight-text">Git Tag</strong> của phiên bản đang bị lỗi (ví dụ: `v1.2.3`) để tạo branch `hotfix/*`.</p><pre><code class="bg-slate-800 p-3 rounded-md text-sky-300 text-sm block">git checkout -b hotfix/fix-critical-bug v1.2.3</code></pre></div>
                             <div class="timeline-item animated slide-up"><div class="timeline-dot"></div><h4 class="text-lg font-bold mb-2">2. Sửa lỗi và Commit</h4><p class="mb-4">Sửa lỗi nhanh chóng, commit và mở PR vào `main`.</p></div>
                              <div class="timeline-item animated slide-up"><div class="timeline-dot"></div><h4 class="text-lg font-bold mb-2">3. Merge vào `main` và Tag Phiên Bản Vá</h4><p class="mb-4">Sau khi PR được review và merge vào `main`, ngay lập tức tạo một tag phiên bản vá lỗi (ví dụ: `v1.2.4`).</p><pre><code class="bg-slate-800 p-3 rounded-md text-sky-300 text-sm block">git checkout main
git pull
git tag -a <span class="text-yellow-300">v1.2.4</span> -m "Hotfix for critical bug"
git push origin main --tags</code></pre></div>
                               <div class="timeline-item animated slide-up"><div class="timeline-dot"></div><h4 class="text-lg font-bold mb-2">4. Deploy khẩn cấp</h4><p class="mb-4">CI/CD sẽ nhận diện tag `v1.2.4` mới và deploy phiên bản đã vá lỗi ra Production.</p></div>
                         </div>
                    </div>
                    <div>
                        <h3 class="flex items-center text-2xl font-bold mb-6"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-3 text-amber-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12.066 11.2a1 1 0 000 1.6l5.334 4A1 1 0 0019 16V8a1 1 0 00-1.6-.8l-5.333 4zM4.066 11.2a1 1 0 000 1.6l5.334 4A1 1 0 0011 16V8a1 1 0 00-1.6-.8l-5.334 4z" /></svg>Quy Trình Revert (Ví dụ cụ thể)</h3>
                        <p class="mb-6 text-sm bg-sky-900/50 p-3 rounded-md border-l-4 border-sky-400"><strong class="highlight-text">Khi nào dùng?</strong> Khi một phiên bản vừa deploy gây ra lỗi hệ thống nghiêm trọng và cần quay lại phiên bản ổn định <strong class="highlight-text">ngay lập tức</strong> một cách an toàn.</p>
                         <div class="relative timeline-container">
                             <div class="timeline-item animated slide-up"><div class="timeline-dot"></div><h4 class="text-lg font-bold mb-2">1. Xác định Commit Lỗi</h4><p class="mb-4">Giả sử `git log` cho thấy lịch sử gần đây của `main`:</p><pre><code class="bg-slate-800 p-3 rounded-md text-slate-400 text-sm block">$ git log --oneline -n 3
<code class="commit-hash" style="color:#f87171; background-color: #450a0a;">e4f5g6h</code> (HEAD -> main, tag: v2.0.0) feat(api): Add new payment endpoint
<code class="commit-hash">a1b2c3d</code> fix(ui): Correct button alignment
<code class="commit-hash">c7d8e9f</code> docs: Update README</code></pre><p>Ta xác định commit <code class="commit-hash" style="color:#f87171; background-color: #450a0a;">e4f5g6h</code> là nguyên nhân gây lỗi.</p></div>
                             <div class="timeline-item animated slide-up"><div class="timeline-dot"></div><h4 class="text-lg font-bold mb-2">2. Tạo Commit Hoàn Tác</h4><p class="mb-4">Chạy lệnh `git revert` với mã hash của commit lỗi. Lệnh này không xóa lịch sử, mà tạo một commit mới an toàn.</p><pre><code class="bg-slate-800 p-3 rounded-md text-sky-300 text-sm block">git revert e4f5g6h</code></pre></div>
                              <div class="timeline-item animated slide-up"><div class="timeline-dot"></div><h4 class="text-lg font-bold mb-2">3. Tag Phiên Bản Rollback</h4><p class="mb-4">Commit `Revert` mới đã được tạo trên `main`. Để deploy phiên bản an toàn này, ta tạo một Tag mới.</p><pre><code class="bg-slate-800 p-3 rounded-md text-slate-400 text-sm block">$ git log --oneline -n 2
<code class="commit-hash" style="color:#4ade80; background-color: #14532d;">b8a9d1c</code> (HEAD -> main) Revert "feat(api): Add new payment endpoint"
<code class="commit-hash">e4f5g6h</code> (tag: v2.0.0) feat(api): Add new payment endpoint
...</code></pre><pre><code class="bg-slate-800 p-3 rounded-md text-sky-300 text-sm block">git tag -a v2.0.1 -m "Rollback payment endpoint feature"
git push origin main --tags</code></pre></div>
                               <div class="timeline-item animated slide-up"><div class="timeline-dot"></div><h4 class="text-lg font-bold mb-2">4. Deploy phiên bản Rollback</h4><p class="mb-4">CI/CD sẽ nhận diện tag `v2.0.1` và deploy phiên bản ổn định này ra Production.</p></div>
                         </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="text-center py-10 border-t border-slate-800 mt-16">
        <p class="text-slate-500">Tài liệu hướng dẫn quy trình phát triển chuyên nghiệp.</p>
    </footer>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const animatedElements = document.querySelectorAll('.animated');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                        observer.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.1 });
            animatedElements.forEach(el => observer.observe(el));
            
            // --- FIXED CI/CD LOGIC ---
            const startBtn = document.getElementById('start-btn');
            const preprodBtn = document.getElementById('preprod-btn');
            const stagingBtn = document.getElementById('staging-btn');
            const resetBtn = document.getElementById('reset-btn');
            const artifact = document.getElementById('artifact');
            const artifactTag = document.getElementById('artifact-tag');
            const buildStageEl = document.getElementById('build-stage');
            const preprodStageEl = document.getElementById('preprod-stage');
            const stagingStageEl = document.getElementById('staging-stage');
            const prodStageEl = document.getElementById('prod-stage');
            const buildStageDesc = buildStageEl.querySelector('.stage-description');
            const preprodStageDesc = preprodStageEl.querySelector('.stage-description');
            const stagingStageDesc = stagingStageEl.querySelector('.stage-description');
            const prodStageDesc = prodStageEl.querySelector('.stage-description');

            const preprodConfig = document.getElementById('preprod-config');
            const stagingConfig = document.getElementById('staging-config');
            const prodConfig = document.getElementById('prod-config');
            let currentState = 'initial';
            let currentTag = '';

            const getTargetX = (stage) => {
                if (!stage || !artifact) return 0;
                return stage.offsetLeft + stage.offsetWidth / 2 - artifact.offsetWidth / 2;
            }

            const resetState = () => {
                currentState = 'initial';
                if (!artifact || !buildStageEl) return;
                artifact.style.transition = 'none';
                artifact.style.opacity = '0';
                artifact.style.transform = `scale(0.5)`;
                artifact.style.left = `${getTargetX(buildStageEl)}px`;
                
                [preprodConfig, stagingConfig, prodConfig].forEach(c => c && c.classList.remove('show'));
                
                startBtn.classList.remove('hidden');
                startBtn.disabled = false;
                startBtn.classList.add('active');

                preprodBtn.classList.add('hidden');
                stagingBtn.classList.add('hidden');
                resetBtn.classList.add('hidden');
                
                preprodBtn.classList.remove('active');
                stagingBtn.classList.remove('active');
                resetBtn.classList.remove('active');

                artifactTag.textContent = '';
                buildStageDesc.innerHTML = 'Tạo ra một artifact (vd: Docker image) có thể deploy.';
                preprodStageDesc.innerHTML = 'Deploy tự động cho QA/QC kiểm thử tích hợp.';
                stagingStageDesc.innerHTML = 'Chờ phê duyệt và tạo Git Tag để deploy Production.';
                prodStageDesc.innerHTML = 'Deploy cho người dùng cuối sau khi có Git Tag mới.';


                setTimeout(() => { 
                    if(artifact) artifact.style.transition = 'all 1.5s cubic-bezier(0.68, -0.55, 0.27, 1.55)'; 
                }, 50);
            };
            
            resetState();

            startBtn.addEventListener('click', () => {
                if (currentState === 'initial') {
                    currentState = 'building';
                    startBtn.disabled = true;
                    startBtn.classList.remove('active');
                    currentTag = (Math.random() + 1).toString(36).substring(2, 9);
                    artifactTag.textContent = currentTag;
                    buildStageDesc.innerHTML = `Đã tạo artifact: <code class="commit-hash">${currentTag}</code>`;

                    artifact.style.opacity = '1';
                    artifact.style.transform = 'scale(1)';
                    setTimeout(() => {
                        artifact.style.left = `${getTargetX(preprodStageEl)}px`;
                        setTimeout(() => {
                            if(preprodConfig) preprodConfig.classList.add('show');
                            preprodStageDesc.innerHTML = `Đang deploy artifact <code class="commit-hash">${currentTag}</code>...`;
                            startBtn.classList.add('hidden');
                            preprodBtn.classList.remove('hidden');
                            preprodBtn.disabled = false;
                            preprodBtn.classList.add('active');
                            currentState = 'in_preprod';
                        }, 1500);
                    }, 500);
                }
            });

            preprodBtn.addEventListener('click', () => {
                if (currentState === 'in_preprod') {
                    currentState = 'to_staging';
                    preprodBtn.disabled = true;
                    preprodBtn.classList.remove('active');
                    if(preprodConfig) preprodConfig.classList.remove('show');
                    artifact.style.left = `${getTargetX(stagingStageEl)}px`;
                    setTimeout(() => {
                        if(stagingConfig) stagingConfig.classList.add('show');
                        stagingStageDesc.innerHTML = `Artifact <code class="commit-hash">${currentTag}</code> đã được QA test OK. Sẵn sàng tạo tag!`;
                        preprodBtn.classList.add('hidden');
                        stagingBtn.classList.remove('hidden');
                        stagingBtn.disabled = false;
                        stagingBtn.classList.add('active');
                        currentState = 'in_staging';
                    }, 1500);
                }
            });

            stagingBtn.addEventListener('click', () => {
                if (currentState === 'in_staging') {
                    currentState = 'to_prod';
                    stagingBtn.disabled = true;
                    stagingBtn.classList.remove('active');
                    if(stagingConfig) stagingConfig.classList.remove('show');
                    stagingStageDesc.innerHTML = `Đã tạo tag <code class="commit-hash">v1.3.0</code> cho artifact <code class="commit-hash">${currentTag}</code>`;
                    artifact.style.left = `${getTargetX(prodStageEl)}px`;
                    setTimeout(() => {
                        if(prodConfig) prodConfig.classList.add('show');
                        prodStageDesc.innerHTML = `Đã deploy thành công phiên bản <code class="commit-hash">v1.3.0</code>!`;
                        stagingBtn.classList.add('hidden');
                        resetBtn.classList.remove('hidden');
                        resetBtn.disabled = false;
                        resetBtn.classList.add('active');
currentState = 'in_prod';
                    }, 1500);
                }
            });

            resetBtn.addEventListener('click', () => {
                if (currentState === 'in_prod') {
                    resetState();
                }
            });

            window.addEventListener('resize', resetState);
        });
    </script>
</body>
</html>
